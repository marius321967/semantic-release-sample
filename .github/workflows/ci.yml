name: Release

on:
  push:
    branches: 
      - master
      - tutorial
  workflow_dispatch:

jobs:
  test-docker-image:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup config.json
        run: cp config/config.sample.json config/config.json
      - name: Docker Image smoke test
        run: |
          docker-compose \
            -f docker-compose.ci.yml \
            up \
            --build \
            --exit-code-from test \
            test

  release:
    needs:
      - test-docker-image
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      # release step...